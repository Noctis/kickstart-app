# Upgrading from 3.0.0 to 3.1.0

## 1. Dependencies

First and foremost, run the following command to update Kickstart to 3.1.0:

```shell
$ composer require --with-all-dependencies noctis/kickstart:~3.1.0
```

## 2. HTTP Entry Point

Edit your application's `public/index.php` file and move importing routes list from 
`Noctis\KickStart\Provider\RoutingProvider`'s constructor to the `setRoutes()` method of the 
`Noctis\KickStart\Http\WebApplication` class.

For example, if your `public/index.php` looks like this:

```php
<?php

declare(strict_types=1);

// ...
use Noctis\KickStart\Http\ContainerBuilder;
use Noctis\KickStart\Http\WebApplication;
use Noctis\KickStart\Provider\RoutingProvider;

require_once __DIR__ . '/../bootstrap.php';

$containerBuilder = new ContainerBuilder();
$containerBuilder
    ->registerServicesProvider(new RoutingProvider(
        require_once __DIR__ . '/../src/Http/Routing/routes.php'
    ))
    // ...
;

// ...

/** @var WebApplication $app */
$app = $container->get(WebApplication::class);
$app->run();
```

this is how it should look after your changes:

```php
<?php

declare(strict_types=1);

// ...
use Noctis\KickStart\Http\ContainerBuilder;
use Noctis\KickStart\Http\WebApplication;
use Noctis\KickStart\Provider\RoutingProvider;

require_once __DIR__ . '/../bootstrap.php';

$containerBuilder = new ContainerBuilder();
$containerBuilder
    ->registerServicesProvider(new RoutingProvider())
    // ...
;

//...

/** @var WebApplication $app */
$app = $container->get(WebApplication::class);
$app->setRoutes(
    require_once __DIR__ . '/../src/Http/Routing/routes.php'
);
$app->run();
```

Now edit the application's `public/.htaccess` file and modify this section:

```apacheconf
RewriteCond %{REQUEST_URI} !=/favicon.ico
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [QSA,L]
```

to look like this:
```apacheconf
RewriteCond %{REQUEST_URI} !=/favicon.ico
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [QSA,L]
```

## 3. Docker

Replace the contents of your application's `Dockerfile` with its 
[`3.1.0` version](https://github.com/Noctis/kickstart-app/blob/3.1.0/Dockerfile).

Copy the `docker-compose.yml` file from the 
[`3.1.0` branch](https://github.com/Noctis/kickstart-app/blob/3.1.0/docker-compose.yml) into your application's root 
directory, next to the `Dockerfile`.

## 4. Cherry on Top

Lastly, update the Kickstart version indicator in your application's `composer.json` file:

```json
"extra": {
    "app-version": "3.1.0"
}
```

and run the following command in your console to update the `composer.lock` file:
```sh
$ composer update --lock
```